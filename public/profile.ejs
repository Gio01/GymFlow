<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GymFlow</title>
    <link rel="stylesheet" href="./styles/index.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
</head>

<body>


    <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>

    <div class="wrapper" style="display: flex; flex-direction: column;">
	    <div id="top_nav" class="top_navbar">
            <div class="hamburger">
                <div class="one"></div>
                <div class="two"></div>
                <div class="three"></div>
            </div>
            <div class="top_menu">
                <div class="logo">
			<img src="./img/GymFlow.jpeg" alt="GymFlow"
			style="height: 50%; width: 55%;">
		</div>
                <ul>
                    <li>
                        <a href="/login" display="none">
                            <i class="fas fa-user"></i>
                        </a>
                    </li>
                    <br>
                    <li>
                        <a href="#" class="logged-out" display="none" id="logout">
                            <i class="fas fa-sign-out-alt" style="padding-top: 0;"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="sidebar" style="display: flex; position:fixed; height: 100%;">
            <ul>
                <li>
                    <a href="/" display="none">
                        <span class=" icon"><i class="fas fa-home"></i></span>
                        <span class="title">Home</span>
                    </a>
                </li>
                <li>
                    <a href="/fitness" display="none">
                        <span class="icon"><i class="fas fa-dumbbell"></i></span>
                        <span class="title">Fitness</span>
                    </a>
                </li>
                <li>
                    <a class="logged-in" href="/profile" display="none">
                        <span class="icon"><i class="fas fa-id-card"></i></span>
                        <span class="title">Profile</span>
                    </a>
                </li>
                <li>
                    <a href="/program" display="none">
                        <span class="icon"><i class="fa fa-map-signs" aria-hidden="true"></i></span>
                        <span class="title">Program</span>
                    </a>
                </li>
                <li>
                    <a href="/contact" display="none">
                        <span class="icon"><i class="fas fa-address-book"></i></span>
                        <span class="title">Contact</span>
                    </a>
                </li>
            </ul>
        </div>
        <!--Main Content------------------>

        <div class="main_container" style="margin-top: 25px;">

            <br>
            <br>
            <div class="item">
                <h1>Profile</h1>
                <br />
                <div class="profile-data"></div>
            </div>

            <div class="item">
                <h1>Bio</h1>
                <br />
                <div class="bio">
                    Bio stuff.
                </div>
                <br>

            </div>
            <!--
            <div class="item">
                <h1>Social Media</h1>
                <br />
                <p class="media-acc">
                    Media account links.
                </p>
                <br>

            </div>
        -->

</div>




            <!---Main content ends ------------------>

        </div>

    </div>
    </div>
    <script src="./scripts/navscripts.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-firestore.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-analytics.js"></script>

    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyCVqKw0SWmEoRtIiJaCM-hRJUxRA3Mbc1g",
            authDomain: "gymflow-47c9b.firebaseapp.com",
            databaseURL: "https://gymflow-47c9b.firebaseio.com",
            projectId: "gymflow-47c9b",
            storageBucket: "gymflow-47c9b.appspot.com",
            messagingSenderId: "728577478893",
            appId: "1:728577478893:web:d86266b8cfa6b13f99bce4",
            measurementId: "G-M97878F1TC"};
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        // Make auth and firestore references!
        const auth = firebase.auth();
        const db = firebase.firestore();

        //listen for auth
        auth.onAuthStateChanged(user => {
            //if user is logged in then show data & if not then don't show anything
            if (user) {
                //console.log(user);

                setupUI(user) //we need to pass the user into the setupUI
                //to allow for the UI to appwar based on when the user is logged in or not

            } else {
                exercises([]);


            }

        });
        //logout method
        const logout = document.querySelector("#logout");
        logout.addEventListener('click', (e) => {
            e.preventDefault();
            auth.signOut().then(() => {
                console.log("User Logged Out!");
            });
        })


        const loggedOutLinks = document.querySelectorAll('.logged-out');
        const loggedInLinks = document.querySelectorAll('.logged-in');
        const profileData = document.querySelector('.profile-data');
        const bio = document.querySelector('.bio');
        const workouts = document.querySelector('#workouts');
        //const media = document.querySelector('.media-acc');


        const setupUI = user => {
            if (user) {
                // user account info
                const html = `<div> Logged in as ${user.email}</div>`;
                profileData.innerHTML = html; // we are assigng the value of profile to be the html variable
                //console.log(user.uid);
                db.collection('users').doc(user.uid).get().then(doc => {
                    const html = `<div> Logged in as ${user.email}</div>`;
                    profileData.innerHTML =
                        html; // we are assigng the value of profile to be the html variable
                    if (doc.data().bio) {
                        const ubio = `<div> ${doc.data().bio}</div>`
                        bio.innerHTML = ubio;
                    } else {
                        console.log('no user bio')
                    }
                });

                //toggle UI elements
                loggedInLinks.forEach(item => {
                    item.style.display = 'block'
                });
                loggedOutLinks.forEach(item => {
                    item.style.display = 'none'
                })
            } else {

                profileData.innerHTML = '';

                loggedInLinks.forEach(item => {
                    item.style.display = 'none'
                });
                loggedOutLinks.forEach(item => {
                    item.style.display = 'block'
                })
            }
        };
    </script>

</body>

</html>
